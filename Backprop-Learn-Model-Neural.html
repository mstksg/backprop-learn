<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Backprop.Learn.Model.Neural</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Backprop.Learn.Model.Neural.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">backprop-learn-0.1.0.0: Combinators and useful tools for ANNs using the backprop library</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Backprop.Learn.Model.Neural</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Fully connected</a><ul><li><a href="#g:2">Feed-forward</a><ul><li><a href="#g:3">With activation function</a></li></ul></li><li><a href="#g:4">Recurrent</a><ul><li><a href="#g:5">With activation function</a></li></ul></li></ul></li></ul></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:FC">FC</a> i o = <a href="Backprop-Learn-Model-Regression.html#t:LinReg" title="Backprop.Learn.Model.Regression">LinReg</a> i o</li><li class="src short"><span class="keyword">pattern</span> <a href="#v:FC">FC</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a> i o</li><li class="src short"><span class="keyword">type</span> <a href="#t:FCp">FCp</a> = <a href="Backprop-Learn-Model-Regression.html#t:LRp" title="Backprop.Learn.Model.Regression">LRp</a></li><li class="src short"><a href="#v:fcBias">fcBias</a> :: <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-" title="Lens.Micro.Type">Lens'</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> i o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)</li><li class="src short"><a href="#v:fcWeights">fcWeights</a> :: <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens" title="Lens.Micro.Type">Lens</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> i o) (<a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> i' o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i')</li><li class="src short"><span class="keyword">type</span> <a href="#t:FCA">FCA</a> i o = <a href="Backprop-Learn-Model-Combinator.html#t:RMap" title="Backprop.Learn.Model.Combinator">RMap</a> (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a> i o)</li><li class="src short"><span class="keyword">pattern</span> <a href="#v:FCA">FCA</a> :: (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)) -&gt; <a href="Backprop-Learn-Model-Neural.html#t:FCA" title="Backprop.Learn.Model.Neural">FCA</a> i o</li><li class="src short"><a href="#v:_fcaActivation">_fcaActivation</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FCA" title="Backprop.Learn.Model.Neural">FCA</a> i o -&gt; <span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)</li><li class="src short"><span class="keyword">type</span> <a href="#t:FCR">FCR</a> h i o = <a href="Backprop-Learn-Model-State.html#t:Recurrent" title="Backprop.Learn.Model.State">Recurrent</a> (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> (i <a href="../base-4.11.0.0/GHC-TypeNats.html#t:-43-" title="GHC.TypeNats">+</a> h)) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> i) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a> (i <a href="../base-4.11.0.0/GHC-TypeNats.html#t:-43-" title="GHC.TypeNats">+</a> h) o)</li><li class="src short"><span class="keyword">pattern</span> <a href="#v:FCR">FCR</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h)) -&gt; <a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a> h i o</li><li class="src short"><span class="keyword">type</span> <a href="#t:FCRp">FCRp</a> h i o = <a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> (i <a href="../base-4.11.0.0/GHC-TypeNats.html#t:-43-" title="GHC.TypeNats">+</a> h) o</li><li class="src short"><a href="#v:fcrBias">fcrBias</a> :: <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-" title="Lens.Micro.Type">Lens'</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)</li><li class="src short"><a href="#v:fcrInputWeights">fcrInputWeights</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i', <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> o) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens" title="Lens.Micro.Type">Lens</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i o) (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i' o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i')</li><li class="src short"><a href="#v:fcrStateWeights">fcrStateWeights</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h', <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> o) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens" title="Lens.Micro.Type">Lens</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i o) (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h' i o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o h) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o h')</li><li class="src short"><span class="keyword">type</span> <a href="#t:FCRA">FCRA</a> h i o = <a href="Backprop-Learn-Model-Combinator.html#t:RMap" title="Backprop.Learn.Model.Combinator">RMap</a> (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a> h i o)</li><li class="src short"><span class="keyword">pattern</span> <a href="#v:FCRA">FCRA</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h)) -&gt; (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)) -&gt; <a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a> h i o</li><li class="src short"><a href="#v:_fcraStore">_fcraStore</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a> h i o -&gt; <span class="keyword">forall</span> s. (<a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a>, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h)</li><li class="src short"><a href="#v:_fcraActivation">_fcraActivation</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a> h i o -&gt; <span class="keyword">forall</span> s. (<a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a>, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fully connected</h1></a><a href="#g:2" id="g:2"><h2>Feed-forward</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FC" class="def">FC</a> i o = <a href="Backprop-Learn-Model-Regression.html#t:LinReg" title="Backprop.Learn.Model.Regression">LinReg</a> i o <a href="src/Backprop.Learn.Model.Neural.html#FC" class="link">Source</a> <a href="#t:FC" class="selflink">#</a></p><div class="doc"><p>Fully connected feed-forward layer with bias.  Parameterized by its
 initialization distribution.</p><p>Note that this has no activation function; to use as a model with
 activation function, chain it with an activation function using <code><a href="Backprop-Learn-Model-Combinator.html#t:RMap" title="Backprop.Learn.Model.Combinator">RMap</a></code>,
 <code><a href="Backprop-Learn-Model-Combinator.html#t::.-126-" title="Backprop.Learn.Model.Combinator">:.~</a></code>, etc.; see <code><a href="Backprop-Learn-Model-Neural.html#t:FCA" title="Backprop.Learn.Model.Neural">FCA</a></code> for a convenient type synonym and constructor.</p><p>Without any activation function, this is essentially a multivariate
 linear regression.</p><p>With the logistic function as an activation function, this is
 essentially multivariate logistic regression. (See <code>Logistic</code>)</p></div></div><div class="top"><p class="src"><span class="keyword">pattern</span> <a id="v:FC" class="def">FC</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a> i o <a href="src/Backprop.Learn.Model.Neural.html#FC" class="link">Source</a> <a href="#v:FC" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FCp" class="def">FCp</a> = <a href="Backprop-Learn-Model-Regression.html#t:LRp" title="Backprop.Learn.Model.Regression">LRp</a> <a href="src/Backprop.Learn.Model.Neural.html#FCp" class="link">Source</a> <a href="#t:FCp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:fcBias" class="def">fcBias</a> :: <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-" title="Lens.Micro.Type">Lens'</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> i o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) <a href="src/Backprop.Learn.Model.Neural.html#fcBias" class="link">Source</a> <a href="#v:fcBias" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:fcWeights" class="def">fcWeights</a> :: <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens" title="Lens.Micro.Type">Lens</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> i o) (<a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> i' o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i') <a href="src/Backprop.Learn.Model.Neural.html#fcWeights" class="link">Source</a> <a href="#v:fcWeights" class="selflink">#</a></p></div><a href="#g:3" id="g:3"><h3>With activation function</h3></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FCA" class="def">FCA</a> i o = <a href="Backprop-Learn-Model-Combinator.html#t:RMap" title="Backprop.Learn.Model.Combinator">RMap</a> (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a> i o) <a href="src/Backprop.Learn.Model.Neural.html#FCA" class="link">Source</a> <a href="#t:FCA" class="selflink">#</a></p><div class="doc"><p>Convenient synonym for an <code><a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a></code> post-composed with a simple
 parameterless activation function.</p></div></div><div class="top"><p class="src"><span class="keyword">pattern</span> <a id="v:FCA" class="def">FCA</a> :: (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)) -&gt; <a href="Backprop-Learn-Model-Neural.html#t:FCA" title="Backprop.Learn.Model.Neural">FCA</a> i o <a href="src/Backprop.Learn.Model.Neural.html#FCA" class="link">Source</a> <a href="#v:FCA" class="selflink">#</a></p><div class="doc"><p>Construct an <code><a href="Backprop-Learn-Model-Neural.html#t:FCA" title="Backprop.Learn.Model.Neural">FCA</a></code> using a generating function and activation
 function.</p><p>Some common ones include <code>logistic</code> and <code><code><a href="Backprop-Learn-Model-Function.html#v:vmap" title="Backprop.Learn.Model.Function">vmap</a></code> <code>reLU</code></code>.</p></div></div><div class="top"><p class="src"><a id="v:_fcaActivation" class="def">_fcaActivation</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FCA" title="Backprop.Learn.Model.Neural">FCA</a> i o -&gt; <span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) <a href="src/Backprop.Learn.Model.Neural.html#_fcaActivation" class="link">Source</a> <a href="#v:_fcaActivation" class="selflink">#</a></p></div><a href="#g:4" id="g:4"><h2>Recurrent</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FCR" class="def">FCR</a> h i o = <a href="Backprop-Learn-Model-State.html#t:Recurrent" title="Backprop.Learn.Model.State">Recurrent</a> (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> (i <a href="../base-4.11.0.0/GHC-TypeNats.html#t:-43-" title="GHC.TypeNats">+</a> h)) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> i) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="Backprop-Learn-Model-Neural.html#t:FC" title="Backprop.Learn.Model.Neural">FC</a> (i <a href="../base-4.11.0.0/GHC-TypeNats.html#t:-43-" title="GHC.TypeNats">+</a> h) o) <a href="src/Backprop.Learn.Model.Neural.html#FCR" class="link">Source</a> <a href="#t:FCR" class="selflink">#</a></p><div class="doc"><p>Fully connected recurrent layer with bias.</p><p>Parameterized by its initialization distributions, and also the function
 to compute the new state from previous input.</p><pre>instance <code>Learn</code> (<code><a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a></code> i) (R o) (<code><a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a></code> h i o) where
    type <code>LParamMaybe</code> (FCR h i o) = '<code><a href="../base-4.11.0.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a></code> (<code><a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a></code> h i o)
    type <code>LStateMaybe</code> (FCR h i o) = 'Just (R h)
</pre></div></div><div class="top"><p class="src"><span class="keyword">pattern</span> <a id="v:FCR" class="def">FCR</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h)) -&gt; <a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a> h i o <a href="src/Backprop.Learn.Model.Neural.html#FCR" class="link">Source</a> <a href="#v:FCR" class="selflink">#</a></p><div class="doc"><p>Construct an <code><a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a></code></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FCRp" class="def">FCRp</a> h i o = <a href="Backprop-Learn-Model-Neural.html#t:FCp" title="Backprop.Learn.Model.Neural">FCp</a> (i <a href="../base-4.11.0.0/GHC-TypeNats.html#t:-43-" title="GHC.TypeNats">+</a> h) o <a href="src/Backprop.Learn.Model.Neural.html#FCRp" class="link">Source</a> <a href="#t:FCRp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:fcrBias" class="def">fcrBias</a> :: <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-" title="Lens.Micro.Type">Lens'</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) <a href="src/Backprop.Learn.Model.Neural.html#fcrBias" class="link">Source</a> <a href="#v:fcrBias" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:fcrInputWeights" class="def">fcrInputWeights</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i', <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> o) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens" title="Lens.Micro.Type">Lens</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i o) (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i' o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o i') <a href="src/Backprop.Learn.Model.Neural.html#fcrInputWeights" class="link">Source</a> <a href="#v:fcrInputWeights" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:fcrStateWeights" class="def">fcrStateWeights</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h', <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> o) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens" title="Lens.Micro.Type">Lens</a> (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h i o) (<a href="Backprop-Learn-Model-Neural.html#t:FCRp" title="Backprop.Learn.Model.Neural">FCRp</a> h' i o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o h) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:L" title="Numeric.LinearAlgebra.Static">L</a> o h') <a href="src/Backprop.Learn.Model.Neural.html#fcrStateWeights" class="link">Source</a> <a href="#v:fcrStateWeights" class="selflink">#</a></p></div><a href="#g:5" id="g:5"><h3>With activation function</h3></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FCRA" class="def">FCRA</a> h i o = <a href="Backprop-Learn-Model-Combinator.html#t:RMap" title="Backprop.Learn.Model.Combinator">RMap</a> (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) (<a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a> h i o) <a href="src/Backprop.Learn.Model.Neural.html#FCRA" class="link">Source</a> <a href="#t:FCRA" class="selflink">#</a></p><div class="doc"><p>Convenient synonym for an <code><a href="Backprop-Learn-Model-Neural.html#t:FCR" title="Backprop.Learn.Model.Neural">FCR</a></code> post-composed with a simple
 parameterless activation function.</p></div></div><div class="top"><p class="src"><span class="keyword">pattern</span> <a id="v:FCRA" class="def">FCRA</a> :: (<a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h)) -&gt; (<span class="keyword">forall</span> s. <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a> =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o)) -&gt; <a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a> h i o <a href="src/Backprop.Learn.Model.Neural.html#FCRA" class="link">Source</a> <a href="#v:FCRA" class="selflink">#</a></p><div class="doc"><p>Construct an <code><a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a></code> using a generating function and activation
 function.</p><p>Some common ones include <code>logistic</code> and <code><code><a href="Backprop-Learn-Model-Function.html#v:vmap" title="Backprop.Learn.Model.Function">vmap</a></code> <code>reLU</code></code>.</p></div></div><div class="top"><p class="src"><a id="v:_fcraStore" class="def">_fcraStore</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a> h i o -&gt; <span class="keyword">forall</span> s. (<a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a>, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> h) <a href="src/Backprop.Learn.Model.Neural.html#_fcraStore" class="link">Source</a> <a href="#v:_fcraStore" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_fcraActivation" class="def">_fcraActivation</a> :: <a href="Backprop-Learn-Model-Neural.html#t:FCRA" title="Backprop.Learn.Model.Neural">FCRA</a> h i o -&gt; <span class="keyword">forall</span> s. (<a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:Reifies" title="Numeric.Backprop">Reifies</a> s <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:W" title="Numeric.Backprop">W</a>, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> h, <a href="../base-4.11.0.0/GHC-TypeNats.html#t:KnownNat" title="GHC.TypeNats">KnownNat</a> i) =&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) -&gt; <a href="../backprop-0.1.5.1/Numeric-Backprop.html#t:BVar" title="Numeric.Backprop">BVar</a> s (<a href="../hmatrix-0.18.2.0/Numeric-LinearAlgebra-Static.html#t:R" title="Numeric.LinearAlgebra.Static">R</a> o) <a href="src/Backprop.Learn.Model.Neural.html#_fcraActivation" class="link">Source</a> <a href="#v:_fcraActivation" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.19.0</p></div></body></html>